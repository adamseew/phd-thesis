
%
%%%%%%%%%%%%%%%%%%
%                %
% Introduction   %
%                %
%%%%%%%%%%%%%%%%%%
%
% Brief abstract: introduction to the rest of the work
%
% Completion (1-10): 8
% Missing: some further motivation would be nice, along some more plots. Methodology is missing, structure is to rewrite with the final structure, the contribution is to be redone as well. Overall consistency check with the final structure is needed
%
\chapter{Introduction}
\label{cp:intro}

\begin{chapquote}{\cite{wang2017curvature}}
  ``Fixed-wing[s] [...] tend to be more stable in the air in the face of both piloting and technical errors as they have natural gliding capabilities even without power, and they are able to travel longer distances on less power.''
\end{chapquote}

\vspace*{1em}

\lettrine{M}{obile robots} have the ability to move~\citep{corke2017robotics} and eventually sense and interact with the surrounding environment. Most of these robots are power-demanding devices constrained by battery limitations. Although common in many areas, these limitations are critical in mobile robots' design and development--they might influence the level of autonomy\findex{autonomy}, only expected to increase in the foreseeable future~\citep{fisher2013verifying}.

To move mobile robots combine and interpret the data from multiple components~\citep{mei2006deployment} via, e.g., various algorithms for perception\findex{perception algorithms} and planning\findex{planning algorithms} on energy-demanding heterogeneous computing hardware\findex{heterogeneous computing hardware}. For instance, with a motion planning algorithm\findex{motion planning}, a mobile robot converts and combine a human-level plan with sensing into some machine-level motion primitives~\citep{lavalle2006planning}\findex{motion primitives}. There are numerous planning algorithms applied to a variety of robots, yet some planning approaches are less explored than others. Planning an energy-aware path with a power-saving scheduling policy\findex{scheduling} on the computing hardware is one of such underrepresented algorithms in the robotics research literature~\citep{sudhakar2020balancing,lahijanian2018resource,ondruska2015scheduled,brateman2006energy}. Past approaches well cover one of these topics, but the interaction between the two is mostly unexplored~\citep{brateman2006energy}. Some generate an energy-optimized path, but the computations\findex{computations} energy might equal the motion in some instances of low-energy mobile robots~\citep{sudhakar2020balancing}. Due to the recent advancements in the computational capabilities of heterogeneous computing hardware, such as the introduction of powerful portable GPUs\findex{GPU}~\citep{rizvi2017general}, the use of computations is then further on the rise~\citep{abramov2012real,satria2016real,jaramillo2019visual}. Others provide a power-saving scheduling policy, yet, moving a mobile robot requires considerable energy expenditure over mere computations~\citep{mei2004energy,mei2005case}.

In this work, we focus on both, investigating their tradeoffs. Within motion planning itself, we focus on a specific category. In autonomous scenarios, it is often required to explore every location in space~\citep{cao1988region}, a problem solved by coverage planning~\citep{choset2001coverage}\findex{coverage path planning}. We thus showcase the interaction planning-scheduling on a coverage planning algorithm--we cover a space scheduling high-level task for, e.g., perception, in an elemental region\findex{elemental region}. We demonstrate the approach both in simulation and empirically, and we focus on aerial mobile robots. Although these share with the broader class of mobile robots stringent battery limitations, aerial robots have further complications. In a conventional setup, for instance, it would be required landing to replace or recharge the battery. Aerial robots are thus perhaps an ideal instance of energy-constrained systems that would benefit from energy-aware planning considerations along with scheduling. We will see that we can back such statement with observations of actual flights failure reductions later in this work (in \fref{cp:res}{Chapter}), and thus,  in the remainder, we focus on aerial robots.

There are numerous autonomous use cases involving aerial robots, such as precision agriculture, search and rescue\findex{search and rescue}, payload delivery\findex{payload delivery}, transportation\findex{transportation}, and many others. We formulate the problem later in \fref{cp:pb}{Chapter} having in mind a precision agriculture use case of an autonomous fixed-wing aerial robot flying over an agricultural field with little human input.
\begin{figure}[t]
  \centering
  \includegraphics[width=.7\textwidth]{pictures/photo}
  \caption[Opterra fixed-wing aerial robot]{Opterra fixed-wing aerial robot employed for precision agriculture {\scriptsize(photo credit: Amit Ferencz Appel)}.}
  \label{fig:opterra}
\end{figure}
Precision agriculture\findex{precision agriculture} is indeed often put into practice~\citep{hajjaj2014review} with ground mobile robots used for harvesting~\citep{qingchun2012study,dong2011development, de2011design, aljanobi2010setup, li2008analysis, edan2000robotic}, and aerial robots for preventing damage and ensuring better crop quality~\citep{puri2017agriculture, daponte2019review}. We investigate different physical aerial robotics platforms in this work but we derive most results with the Opterra fixed-wing aerial robot\findex{Opterra fixed-wing aerial robot}~\citep{opterra} adapted for precision agriculture. The aerial robot is in \fref{fig:opterra}{Figure}.

In the remainder of the chapter and before we introduce the problem in \fref{cp:pb}{Chapter}, we briefly investigate the evolution of the field of aerial robotics in \fref{sec:history}{Section}. We then analyze the main aerial robots available today and how they apply to energy-aware planning-scheduling in \fref{sec:aerial-robo-types}{Section}, justifying the fixed-wings. We then provide some further motivation in \fref{sec:motivation}{Section} and the outline of the approach in \fref{sec:outline}{Section}. Finally, we provide the structure of the remaining chapters in \fref{sec:structure}{Section}.

This chapter connects to the remainder of this work as follows. Here we introduce and motivate the energy-aware coverage planning and scheduling for autonomous aerial robots. We formalize the planning problem in \fref{cp:pb}{Chapter} and describe the derivation of an energy model to predict future energy consumption in \fref{cp:model}{Chapter}. We derive an optimal configuration of the path and computations using data-driven control\findex{data-driven control} and other modern optimal control techniques in \fref{cp:dyn}{Chapter}. In the same chapter, we provide some details for guidance, which physically moves the robot. We use such configuration for coverage planning and scheduling of the aerial robot experimentally in \fref{cp:res}{Chapter}. Moreover, we discuss previous approaches in the literature that are relevant to our work in \fref{cp:soa}{Chapter}. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{From UAVs to Modern Aerial Robots}
\label{sec:history}

Modern aerial robots are a valuable tool in robotic research and aerospace, found with different names in the literature. These include unmanned aerial vehicles\findex{unmanned aerial vehicles} (\Gls{acr:uav}s)\footnote{The term unmanned is sometimes replaced by uninhabited}, unmanned aerial systems\findex{unmanned aerial systems} (\Gls{acr:uas}s), flying robots, or drones. Usually, we refer to drones, UAVs, and UASs when these systems are semi-autonomous, operated from the ground--UAS often denotes the entire infrastructure of unmanned flight in the aerospace jargon--whereas aerial or flying robots when they have advanced levels of autonomy~\citep{siciliano2016springer}. Nevertheless, all these systems have basic autonomous features such as position and altitude holding, and leveling. The position holding is usually implemented using the global navigation satellite system\findex{global navigation satellite system} (\Gls{acr:gnss}), altitude holding using a barometer\findex{barometer}, and leveling using the inertial measurement unit\findex{inertial measurement unit} (\Gls{acr:imu}).

\begin{figure}[t]
  \centering
  \includegraphics[width=.7\textwidth]{pictures/HA-NH-JA-19_1}
  \caption[Hewitt-Sperry Automatic Airplane, first unmanned flying machine]{The Hewitt-Sperry Automatic Airplane, also denominated ``flying bomb'', was developed in WWI and represents the first instance of a \Gls{acr:uav} {\scriptsize(photo credit: United States Naval Institute)}.}   
  \label{fig:hewitt-sperry}
\end{figure}
The origin of the field of aerial robotics, which deals with the design and development of aerial robots, dates back to the first guided missiles: unmanned (or uninhabited) flight has more than a century of developments~\citep{siciliano2016springer}. Hewitt-Sperry Automatic Airplane\findex{Hewitt-Sperry automatic airplane} in \fref{fig:hewitt-sperry}{Figure}, also denominated ``flying bomb'' and developed in 1917 during World War~I\findex{World War I}~(WWI)~\citep{keane2013brief,valavanis2015handbook}, is often referred to as the first unmanned flying machine. Developed 14 years after the first heavier-than-air flight in history--demonstrated on December 17, 1903, with the Wright Flyer I by Wilbur and Orville Wright\findex{Wright brother} (or the Wright brothers)--it used a gyroscope\findex{gyroscope} invented shortly before by Elmer Sperry~\citep{keane2013brief}, similarly to modern aerial robots. The device was mechanically connected to the control surfaces, successfully implementing a control feedback loop~\citep{siciliano2016springer}.

In their early days, these first flying machines were referred to as remotely piloted vehicles\findex{remotely piloted vehicles} (\Gls{acr:rpv}s)~\citep{anderson2005introduction}. Many instances from WWI were designed for military purposes. In the 1950s, United States used a remotely controlled vehicle, the Ryan Firebee\findex{Ryan Firebee}, for reconnaissance in Vietnam, and Israel was the first to use an \Gls{acr:rpv} in a combat situation~\citep{anderson2005introduction}. Other instances include the V-1 flying bomb~\findex{V-1 flying bomb} from 1944 (deployed by the unified armed forces of nazi Germany) and the Lockheed D-21~\findex{Lockheed D-21} from 1962 (deployed by the United States Air Force). Global positioning system\findex{global positioning system} (\Gls{acr:gps}) at the end of 1970 allowed some more recent applications, including surveillance. These systems were later integrated with cameras and other sensors~\citep{siciliano2016springer}, in what are the modern aerial robots.

Unmanned flight has entered many civilian applications in recent years~\citep{gonzalez2017unmanned}. Aerial robots are used increasingly in remote sensing\findex{remote sensing}~\citep{colomina2014unmanned,noor2018remote,tang2015drone,milas2018drones}, surveillance\findex{surveillance}~\citep{acevedo2014one,ramasamy2017heuristic,basilico2015deploying,paucar2018use,burkle2009collaborating}, meteorology\findex{meteorology}~\citep{renzaglia2016monitoring,schuyler2019using}, search and rescue\findex{search and rescue}~\citep{hayat2017multi,pensieri2020drones,karaca2018potential,cui2015drones,seguin2018unmanned}, precision agriculture~\citep{popovic2017online,sa2018weednet,lottes2017uav,daponte2019review,puri2017agriculture}, transportation, and payload delivery\findex{payload delivery}~\citep{kellermann2020drones}. The former four categories fall into reconnaissance, surveillance, and target acquisition\findex{reconnaissance, surveillance, and target acquisition} (\Gls{acr:rsta}) and do not require advanced autonomy, while precision agriculture, transportation, and payload delivery utilize a certain extent of computational intelligence~\citep{siciliano2016springer}. These systems handle unexplored terrain with little interaction, whereas the past UAVs were operated mainly by a human operator~\citep{siciliano2016springer}. Instances autonomously adapt and possibly interact in a wide variety of environmental conditions.

\begin{figure}[t]
  \sfr
  \centering
  \includegraphics[width=.7\textwidth]{pictures/jpegPIA24550}
  \caption[NASA's Ingenuity Mars Helicopter]{NASA's Ingenuity Mars Helicopter. A rotary-wing coax aerial robot that achieved the first powered, controlled flight on another planet on April 19, 2021. The project is solely a demonstration of technology {\scriptsize(photo credit: NASA Jet Propulsion Laboratory)}.}   
  \label{fig:ingenuity}
  \efr
\end{figure}

In summary, aerial robots have a relatively recent past. Some initial experiments of unmanned flights were performed shortly after the first heavier-than-air manned and powered flight. These initial experiments were often developed for military purposes, whereas modern aerial robots fly in a broad range of civilian applications. Aerial robots are expected to grow significantly in numerous areas of robotics research ranging from agriculture to planetary exploration. For the latter, \fref{fig:ingenuity}{Figure} shows NASA's Ingenuity Mars Helicopter\findex{Ingenuity Mars Helicopter}\findex{NASA}. A small coaxial aerial robot\findex{coaxial aerial robot}\findex{Mars} that performed the first powered, controlled flight on another planet on April 19, 2021. Aerial robots for planetary exploration are to be further deployed in future explorations endeavors, for instance, to study Saturn's moon Titan~\citep{voosen2019nasa}\findex{Saturn}\findex{Titan}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Common Classes of Aerial Robots}
\label{sec:aerial-robo-types}

Numerous different types of aerial robots have emerged ever since their first introduction. We briefly investigate the most studied classes in the robotics literature and relate them to the energy-aware planning-scheduling in this work. The two most generic classes are heavier-than-air and lighter-than-air aerial robots. Heavier-than-air aerial robots\findex{heavier-than-air aerial robots} are divided into fixed- and rotary-wings~\citep{siciliano2016springer}, and some recent developments in bio-inspired robotics study flapping-wings~\citep{floreano2015science}\findex{flapping-wings}. 

Rotary-wing aerial robots\findex{rotary-wings} are highly maneuverable and can perform stationary vertical flight (commonly referred to as hovering\findex{hovering})~\citep{siciliano2016springer}. These systems can be classified into further categories, which include multirotors\findex{multirotors} (such as quadrotors\findex{quadrotors} or quadcopters\findex{quadcopters}, hexacopters\findex{hexacopters}, and octocopters\findex{octocopters}), conventional helicopters\findex{helicopters} (these have one main and one tail rotor), and coaxes\findex{coax} (these have counter-rotating coaxial rotors)~\citep{corke2017robotics}. Examples of quadrotors are DJI Mavic Mini in \sref{lab:mavic} and DJI Phantom 4 in \sref{lab:phantom} in \fref{fig:robots-vs-power}{Figure}. In the same figure, DJI Agras T16 in \sref{lab:agras} and DJI Matrice 600 in \sref{lab:matrice} are hexacopters.

Fixed-wing aerial robots\findex{fixed-wings} have wings to provide the lift, some control surfaces for maneuvering, and propellers for the forward thrust; a shared principle with a common passenger aircraft~\citep{corke2017robotics}. An example constitutes the Opterra adapted for precision agriculture in \fref{fig:opterra}{Figure}, Cumulus in \sref{lab:cumulus}, Ebee in \sref{lab:ebee}, and Penguin BE in \sref{lab:penguin}~\citep{haugen2016monitoring} in \fref{fig:robots-vs-power}{Figure}. Examples of flapping-wings are Delfly II in \sref{lab:delfly}~\citep{percin2012flow} and Nano-Hummingbird in \sref{lab:nano} in \fref{fig:robots-vs-power}{Figure}. Instances of lighter-than-air aerial robots\findex{lighter-than-air aerial robots} are blimps\findex{blimps} (or non-rigid airships). They usually rely on gas, e.g., helium\findex{helium} enclosed in a protected envelope~\citep{burri2013design}, to generate the lifting force\findex{lift}~\citep{fui2017recent}. An omnidirectional spherical blimp is in \fref{fig:skye-blimp}{Figure}. Blimps are similar to balloons but provide basic maneuverability, whereas a balloon can control merely the altitude~\citep{colombatti2011lighter}.
\begin{figure}[t]
  \sfr
  \centering
  \includegraphics[width=.7\textwidth]{pictures/IMG_2612}
  \caption[Skye, an omnidirectional spherical blimp]{Skye, an omnidirectional spherical blimp developed by ETH Z\"urich for entertainment purposes. It has a camera system and combines the energy-efficient flight of a blimp with the characteristics of a quadrotor {\scriptsize(photo credit: ETH Z\"urich)}.}   
  \label{fig:skye-blimp}
  \efr
\end{figure}
Some other classifications found in aerial robotics literature trade size and maneuverability and include classes as micro aerial vehicles (MAVs)\findex{micro aerial vehicles} or vertical take-off and landing (VTOLs)\findex{vertical take-off and landing} aerial robots. The former are aerial robots with all dimensions lower than 15 centimeters. The latter are aerial robots flying in a fixed-wing configuration except if taking-off and landing, where they use thrust\findex{thrust} from rotors rather than lift from wings. 

Among the classes in this section, rotary-wings are the most maneuverable, and lighter-than-air aerial robots are the least. These, however, have the highest flight time followed by fixed-wing aerial robots. Mixed configurations, such as VTOLs, fall into the intersection of rotary and fixed-wings for what concerns maneuverability and flight time~\citep{siciliano2016springer}. The energy requirements are critical for all aerial robots, but the difference of motion and computations energy (\Gls{acr:mace}) varies greatly. The energy is highest in rotary-wings and lowest in lighten-than-air aerial robots as shown later in \fref{fig:robots-vs-power}{Figure}. Planning-scheduling would thus rely on both for the fixed-wings robots energy-wise while relying almost exclusively on planning for rotary-wing aerial robots. In the former M\&CE is close to zero, in the latter is usually high except in energy optimized designs such as some rotary-wing MAVs. Hypothetically, in lighter-than-air aerial robots, M\&CE might be negative; the planning-scheduling would rely heavily on scheduling.

The classification that we proposed in this section serves the scopes of our work. There are similar efforts for grouping aerial robots by size and propulsion technology~\citep{hoffer2014survey,cabreira2019survey}, but other classifications are possible. For instance, categorizing aerial robots by the altitude they usually fly~\citep{watts2012unmanned}.


%%%%%%%%%%%%%%%%%%%%
\section{Motivation}
\label{sec:motivation}

\begin{figure}[p!]
  \centering
  \footnotesize\fontfamily{phv}\selectfont
  \input{figures/robots-vs-power.tikz}
  \vspace*{42pt}
  \caption[Different aerial robots in relation to the power, flight time, and M\&CE]{Different aerial robots in relation to the power, flight time, and M\&CE with a hypothetical fixed costs for computations energy. The power is expressed using a logarithmic scale. Heavier-than-air aerial robots \sref{lab:cumulus}{}--\sref{lab:nano}{} include flapping-wings \sref{lab:delfly}{},~\sref{lab:nano}{} and have a negative M\&CE (computations scheduling is to be accounted for most in planning), whereas rotary-wings have a positive M\&CE \sref{lab:matrice}{},~\sref{lab:agras}{} (path planning is to be accounted for most in dynamic planning). Some smaller rotary-wings have an M\&CE closer to zero \sref{lab:mavic}{},~\sref{lab:phantom}{}. In general, rotary-wings have a short flight time. Fixed-wings \sref{lab:cumulus}{}--\sref{lab:opterra}{} have a considerably longer flight time and M\&CE close to zero (computations scheduling and path planning have both to be accounted for in dynamic planning). Lighter-than-air aerial robots \sref{lab:skye}{} have hypothetically a relatively long flight time and lower than zero M\&CE {\scriptsize(photos credit: \srefsmaller{lab:cumulus} to Sky-Watch, \srefsmaller{lab:matrice} to Rise Above, \srefsmaller{lab:agras} to Aeromotus, \srefsmaller{lab:mavic} to Digital Photography Review, \srefsmaller{lab:phantom} to ePHOTOzine, and \srefsmaller{lab:nano} to DARPA)}.}
  \label{fig:robots-vs-power}
\end{figure}

Many applications involving aerial robots have strict battery constraints. It is a common problem of most mobile robots~\citep{mei2006energy}, yet, aerial robots are particularly affected; indeed, the availability of the power source might influence their autonomy. An instance is an aerial robot autonomously inspecting a given space by, e.g., detecting ground patterns and notifying other ground-based actors with little human interaction in a precision agriculture use case. For such and many others, aerial robots often rely on computing hardware along with a microcontroller~\citep{dharmadhikari2020motion,william2019aerial,papachristos2015aerial,holper2017cyber}. Computing hardware provides autonomous capabilities and planning, whereas microcontroller\findex{microcontroller} runs motion primitives by directly interfacing actuators (such as servos\findex{servo} for the control surfaces\findex{control surface}) and motors\findex{motor}~\citep{mei2005case}.

\subsection{Path planning and computations scheduling}

It is uncommon to find a ready-to-use solution for both planning the path and scheduling the computations of these systems in an energy-aware fashion~\citep{brateman2006energy,sudhakar2020balancing}. Yet, the energy requirements of the computing hardware are a further complication. It might be potentially advantageous to schedule the computations on the computing hardware and simultaneously to plan the path rather than solving these two separately~\citep{lahijanian2018resource,ondruska2015scheduled} by, e.g., optimizations in terms of the battery state of charge (\Gls{acr:soc}). 

For certain classes of aerial robots with M\&CE close (or lower than) zero, the autonomy can directly influence the battery state. For these classes, it is desirable to reschedule the computations energy-wise in-flight during a motion energy-demanding phase. For instance, a fixed-wing aerial robot might be flying headwinds (with the wind vector parallel and opposite to the direction of motion) and utilizing more energy than planned. It would be of advantage to reschedule the tasks accordingly to save for the motion energy. During the same flight, the wind direction might suddenly change. The fixed-wing craft, now flying tailwinds, requires less motion energy. It could then potentially increase the level of computations by rescheduling the tasks. Later in the flight, the battery might be subject to sudden drops due to, e.g., temperature changes, requiring replanning again by, for instance, shortening the path. Planning-scheduling altogether in all these cases is, perhaps, the most desirable course of action.

In \fref{fig:robots-vs-power}{Figure}, we show the M\&CE against the flight time of different aerial robots. We observe that fixed-wings are the aerial robots that would advantage the most from simultaneous planning-scheduling. They have an M\&CE close to zero and a relatively long flight time. Although some rotary-wings have M\&CE also close to zero, their flight time is generally short. Flapping-wings and lighter-than-air aerial robots require considerably less energy for the motion and have a negative M\&CE.

\subsection{Objective}
\label{sec:objective}

In the remainder of this work, we refer to computational tasks that can be scheduled in an energy-aware fashion as computations, opposed to others with no significant effect on energy consumption. We assume the aerial robot runs the computations on the heterogeneous computing hardware. As an example, we refer to an aerial robot in a precision agriculture use case in \fref{fig:opterra}{Figure}, doing coverage planning while detecting ground hazards. 
\begin{figure}[h!]
  \centering
  \input{figures/plot2.tikz}
  \caption[The coverage problem in a precision agriculture scenario]{The coverage problem in a precision agriculture scenario. The aerial robot has to cover an agricultural field that forms a polygon (blue/transparent area in the frame) and run some autonomous tasks {\scriptsize(photo credit: Amit Ferencz Appel)}.}
  \label{fig:plot2}
\end{figure}
In abstract terms, the field is a polygon in \fref{fig:plot2}{Figure}, and the aerial robot detects some patterns using a convolutional neural network (\Gls{acr:cnn})\findex{convolutional neural network}. The aerial robot further communicates the position of a detected pattern to other, ground-based actors. Detecting the patterns usually involves heterogeneous computing elements (GPU\findex{GPU} and/or multi-core CPU\findex{CPU}\findex{multi-core CPU}) and consumes a significant amount of energy contrary to, e.g., communication. Detection is a computation, communication a task.

We are interested in the energy optimization of the path and schedule under uncertainty (atmospheric interferences) in-flight. Unlike most of the past literature, the approach that we propose plans these two aspects simultaneously. Such planning would find optimal tradeoffs\findex{tradeoffs} between the path, computations, and energy requirements. Current generic solutions for, e.g., aerial robots coverage planning, do not investigate the two aspects simultaneously, nor are they energy-aware. They are often semi-autonomous: the path and computations are static and usually defined using planning software~\citep{daponte2019review} from existing algorithms~\citep{choset2001coverage,galceran2013survey}, with instances including popular flight controllers~\citep{px4,papa}.  This state of practice has prompted us to investigate the possible interaction between planning-scheduling applied to coverage path planning (\Gls{acr:cpp})\findex{coverage path planning}. In the remainder, we will gradually build an energy-aware coverage planning and scheduling approach for autonomous aerial robots. It plans and schedules altogether while the aerial robot is flying and its batteries are draining.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Outline of the Approach}
\label{sec:outline}

For planning-scheduling altogether, we need some information on the use case for both the path and computations. Path-wise, these include data on the coverage area, such as a description of an equivalent polygon. We provide detailed ways of defining the problem later in \fref{cp:pb}{Chapter}. From the polygon, a coverage algorithm generates a plan composed of multiple stages, later eventually replanned by a replanning algorithm in case of, e.g., sudden battery drops. It consists of different stages, and at each stage, the aerial robot flies a path and executes some computations. We use the concept of different stages to model complex paths. For instance, multiple circles and lines, forming the overall coverage. The robot switches between the paths, as soon as it reaches specific triggering points. We will see the plan later in \fref{sec:flight-plan}{Section}. The plan further contains some additional parameters to alter the path and computations along with an energy budget. The alterations are bounded. There are path constraint sets that bound the path alterations and computations constraint sets, one per each computation, that bound computations alterations. We will see these algorithms in \fref{cp:dyn}{Chapter} and the building constructs (plan, stages, parameters, paths, constraints, triggering points) in \fref{cp:pb}{Chapter}. The approach guides the aerial robot with a vector field-based gradient descent algorithm in \fref{sec:gvf}{Section}\findex{vector field}\findex{gradient descent}. 

Computation-wise, we need a way to specify the computations and quantify their energy contribution. We cover these aspects in \fref{cp:model}{Chapter}, along with the motion and battery energy models. The approach relies on \powprof{}, a tool that we introduce in \fref{sec:comp-ener-model}{Section}, part of our early studies~\citep{seewald2019component,seewald2019coarse}. The tool models the power, energy, and battery SoC of the computations and is embedded in the future energy estimations of the aerial robot in \fref{sec:deriv}{Section}. To this end, we empirically derive and formally prove a periodic differential energy model that accounts for the uncertainty. We use Fourier analysis to derive the model and state estimation to address the uncertainty. Periodicity is due to the periodic patterns in the coverage plan, as we will see in \fref{cp:model}{Chapter} and \fref{cp:res}{Chapter}. Indeed, in the coverage, as well as some other autonomous scenarios, the mobile robot often iterates over a set of tasks and paths~\citep{seewald2020mechanical,seewald202Xenergy}. We will back the statement with both experimental and realistic simulated findings in~\fref{cp:res}{Chapter}. Given that the plan is periodic, we expect the energy consumption to evolve (approximately) periodically.

Once we have a plan and all the components to model the energy and battery, we can (re)plan-schedule the coverage online in-flight, aided by modern optimal control techniques, e.g.,  state estimation and model predictive control (MPC)~\citep{rawlings2017model} in \fref{cp:dyn}{Chapter}. The control is data-driven: energy sensor data estimates some coefficients of the model to predict the future energy consumption with uncertainty while obeying the energy budget--the battery capacity and other battery parameters. Our goal is to complete the plan with the highest possible parameters configuration.


%---




%%%%%%%%%%%%%%%%%%%%%%
\section{Applications}

The dynamic energy planning in this work applies to modern aerial robots with a certain degree of autonomy. By the latter, we mean that the robot performs at least a predefined set of tasks over a given space. Although most of the guidance in \fref{cp:dyn}{Chapter} is designed for aerial robots specifically, the approach can be easily adapted to other mobile robots with energy constraints. We discuss applications out of aerial robotics domain further in \fref{cp:conc}{Chapter}. For instance, we have applied the approach to the space robotics context~\citep{seewald2020beyond}. 

In the remainder of this work, we focus on the precision agriculture scenario in \fref{fig:plot2}{Figure}. In summary, the aerial robot covers a given agricultural field (a polygon) and searches for ground hazards. With the scenario, we validated the work experimentally. Path-wise, the aerial robot flies in circles and lines covering the polygon. Computation-wise, it detects hazards using the CNN and notifies grounded mobile robots employed for, e.g., harvesting. The approach alters the plan; it controls the processing rate and the radius of the circles affecting the distance between the lines. We will see this concrete scenario described formally in \fref{sec:flight-plan}{Section} and solved progressively in the remaining chapters.

%We observe that not only the path but also the computations significantly impact the energy, with a potential extension of up to 13 minutes over an hour by switching from the highest to the lowest level of computations in presence of a standard battery.


%%%%%%%%%%%%%%%%%%%%%
\section{\color{red}Methodology}


%%%%%%%%%%%%%%%%%%%%%%
\section{Contribution}

With this work, we contribute with a dynamic planning approach for aerial robots performing autonomous scenarios for different use-cases, under energy constraint, and in an uncertain environment. In particular, we plan both an energy-optimized path and a power-saving schedule. Indeed dynamic planning that incorporates both these aspects simultaneously is underrepresented in the literature. 

The contribution in this work builds upon some other past contributions. In particular, our computational energy modeling relies on an automated profiling and modeling methodology that we proposed in~\citep{seewald2019coarse}. The methodology is based on the \powprof{} tool to derive an energy model for future energy prediction. We proposed an extension of \powprof{} with a component-based energy modeling approach to abstract per-component energy in a dataflow computational network in~\citep{seewald2019component}. We later integrated the tool in a Robot Operating System (ROS)~\citep{quigley2009ros} in~\citep{zamanakos2020energy}.

The agricultural scenario that we briefly introduced in \fref{sec:objective}{Section} is based on simulation of detections over a field under varying atmospheric conditions and with different scheduling options that we proposed in~\citep{zamanakos2020energy}, the energy modeling approach on some empirical observations. We proposed a periodic energy modeling in~\citep{seewald2020mechanical} using the empirical energy data of the Opterra aerial robot flying the precision agriculture scenario. 

A dynamic planning approach that we proposed in~\citep{seewald202Xenergy} relies on all the concepts that we propose in this work and derives simultaneously the energy-optimized path and the power-saving schedule. Additionally to dynamic planning for aerial robots, we studied the approach on different robots in~\citep{seewald2020beyond}.


%%%%%%%%%%%%%%%%%%%
\section{Structure}
\label{sec:structure}

%\begin{figure}[!h]
%  \centering
%  \hspace*{-6ex}
%  \footnotesize\fontfamily{phv}\selectfont
%  \begin{tikzpicture}[auto, node distance=3cm,>=latex']
%      \node [block,node distance=1cm] (theblock0) {Introduction,~\fref{cp:intro}{Ch.}};
%      \node [block,below=1cm,node distance=1cm] (theblock) {Planning Problem,~\fref{cp:pb}{Ch.}};
%      \node [block,below=5.5cm] (theblock2) {Optimal Control Generation,~\fref{cp:opt}{Ch.}};
%      \node [block,below left=1cm and -.6cm of theblock] (theblock3) {Energy Models,~\fref{cp:model}{Ch.}};
%      \node [block,below right=.5cm and 2.3cm of theblock3] (theblock4) {Guidance,~\fref{cp:dyn}{Ch.}};
%      \node [block,below=.5cm and -.5cm of theblock3] (theblock5) {State Estimation,~\fref{cp:est}{Ch.}};
%      \draw [->] (theblock0) -- node{} (theblock);
%      \draw [->] (theblock) -- node{} (theblock2);
%      \draw [->] (theblock5) |- node{} (theblock2);
%      \draw [->] (theblock2) -| node{} (theblock4);
%      \draw [->] (theblock5) -- node{} (theblock3);
%      \draw [->] (theblock) |- node{} (theblock3);
%      \draw [->] (theblock) |-   node{} (theblock4);
%      \draw [decorate,decoration={brace,amplitude=10pt,mirror,raise=64pt},yshift=0pt]
%      (theblock5.north west) -- (theblock5.north west -| theblock4.north east) node [black,midway,yshift=-25ex] (notextnode) {};
%      \node [block,below=-.8cm and -.5cm of notextnode,xshift=-3.3cm] (theblock6) {Implementation,~\fref{app:imp}{App.}};
%      \node [block,below=-.8cm and -.5cm of notextnode,xshift=1.1cm] (theblock8) {Summary and Future Directions,~\fref{cp:conc}{Ch.}};
%      \node [below=-.4cm and -.5cm of notextnode,xshift=-1.62cm] (comma) {,};
%      \node [block,left of=theblock3,node distance=3cm,yshift=1.15cm] (theblock7) {State of the Art,~\fref{cp:soa}{Ch.}};
%      \draw [->] (theblock7) |- node{} (theblock);
%      \draw [->] (theblock7) |- node{} (theblock3);
%      \draw [->] (theblock7) |- node{} (theblock2);
%  \end{tikzpicture}
%  \caption[Diagram of the structure]{Diagram of the structure of this work. The arrows are to be read with ``the chapter influences'' in the direction of the arrow. \fref{cp:intro}{Chapter} serves as an introduction while \fref{cp:soa}{Chapter} presents the state of the art. \fref{cp:pb}{Chapter} presents the planning problem, which is solved in \fref{cp:opt}{Chapter} using notions from \fref{cp:model}{Chapters}\fref{cp:est}{--\hspace*{-.8ex}}. \fref{cp:est}{Chapter} presents the guidance action to move over a replanned. \fref{cp:conc}{Chapter} concludes the work and proposes future directions and \fref{app:imp}{Appendix} the implementation.}
%  \label{fig:structure}
%\end{figure}

The remainder of this work is illustrated in \fref{fig:structure}{Figure} structured as follows. In this chapter, we introduced the dynamic energy planning for aerial robots. We define the planning problem in \fref{cp:pb}{Chapter}, and propose the solution to the problem in \fref{cp:opt}{Chapter}, which builds upon the topics presented in the remaining chapters. In particular, in \fref{cp:soa}{Chapter} we present the state-of-the-art in energy modeling and planning for mobile robots. We include some energy models for heterogeneous computing hardware.

Dynamic planning requires accurate future energy predictions. We present the derivation of some energy models to address future energy predictions in \fref{cp:model}{Chapter}. Specifically, we propose energy models for computations, motion, and the battery. We derive and formally prove a periodic energy model that we use in the remainder of this work to predict future energy consumption. The periodic energy model's accuracy depends on the availability of measurements of energy data. We detail the process in \fref{cp:opt}{Chapter}. We describe how to estimate the coefficients of the periodic energy model and refine the future predictions with the available data.

Flying on a dynamic plan requires the derivation of a guidance action to guide the aerial robot in space. This process is elaborated in \fref{cp:dyn}{Chapter}. We discuss an approach to guide the aerial robot in space on the planned path. 
An optimal solution for the dynamic mobile robot planning problem relies on optimal control techniques. We describe such techniques also in \fref{cp:dyn}{Chapter}. Specifically, after summarizing some of these techniques, we propose an optimization algorithm to select the optimal parameters configuration for the path and computations simultaneously. Finally, we conclude our work in \fref{cp:conc}{Chapter} along some recommendations for future research direction. 

We then present some additional information in appendices. In \fref{app:imp}{Appendix} we propose the implementation in \matlab of the planning problem, the model, the estimation technique, the guidance action, and the derivation of the optimal control. 

